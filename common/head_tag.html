<script type="text/discourse-plugin" version="0.8">
// TOOLBAR
api.addToolbarPopupMenuOptionsCallback(() => {
  return {
      action: "barrer",
      icon: "strikethrough",
      label: "barrer_button"
  };
});
api.addToolbarPopupMenuOptionsCallback(() => {
  return {
    action: "couleur",
    icon: "palette",
    label: "couleur_button"
  };
});
api.addToolbarPopupMenuOptionsCallback(() => {
  return {
    action: "surligner",
    icon: "eraser",
    label: "surligner_button"
  };
});

// ACTIONS
api.modifyClass("controller:composer", {
  pluginId: 'discourse-boutons-extras',
  actions: {
    barrer() {
      this.get("toolbarEvent").applySurround("<s>", "</s>", "barrer_prompt");
    },
    couleur() {
      this.get("toolbarEvent").applySurround("[color=#000000]", "[/color]", "couleur_prompt");
    },
    surligner() {
      this.get("toolbarEvent").applySurround("[su]", "[/su]", "surligner_prompt");
    }
  }
});

// TRADUCTIONS
let translations = I18n.translations[I18n.currentLocale()].js;
if (!translations) {
  translations = {};
}
if (!translations.composer) {
  translations.composer = {};
}
translations.barrer_button = settings.barrer_button_text;
translations.composer.barrer_prompt =
  settings.barrer_prompt;
translations.couleur_button = settings.couleur_button_text;
translations.composer.couleur_prompt =
  settings.couleur_prompt;
translations.surligner_button = settings.surligner_button_text;
translations.composer.surligner_prompt =
  settings.surligner_prompt;
</script>
